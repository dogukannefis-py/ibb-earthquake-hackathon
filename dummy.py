import requests as r
import json as j
import datetime as date
import random as rand
import time as t
from shapely.geometry import Polygon, Point


counter = 500
url = 'http://34.107.62.224:8080'
rand.seed(date.datetime.now().timestamp())
poly_dict = {'1': Polygon([(28.874044, 41.0816226), (28.8755794, 41.0801273), (28.8786181, 41.0771271), (28.8819293, 41.0754167), (28.8855621, 41.074004), (28.8856709, 41.0739449), (28.8887153, 41.071928), (28.8943689, 41.0693637), (28.8946051, 41.0691856), (28.8976602, 41.0668823), (28.9004757, 41.0647596), (28.9026243, 41.0604962), (28.9068088, 41.0573484), (28.909442, 41.0554936), (28.9105404, 41.0542712), (28.9114945, 41.0518916), (28.9124259, 41.0523847), (28.9128523, 41.0526104), (28.9131683, 41.0527777), (28.9142512, 41.053351), (28.9147319, 41.0526622), (28.9158376, 41.0539129), (28.9156694, 41.0546923), (28.9164713, 41.055436), (28.9180971, 41.0547648), (28.9190826, 41.0541666), (28.9196594, 41.0540925), (28.9202364, 41.0541485), (28.9211978, 41.0535685), (28.9221353, 41.0534235), (28.922616, 41.0538222), (28.9225679, 41.0545835), (28.9228083, 41.0551454), (28.9234092, 41.0552179), (28.9242024, 41.0544204), (28.9243224, 41.0545494), (28.9253322, 41.0556348), (28.9257889, 41.0557798), (28.926249, 41.0546396), (28.9262936, 41.0545291), (28.927159, 41.0542754), (28.9272311, 41.0553629), (28.9270869, 41.0561786), (28.9277118, 41.0562692), (28.9289377, 41.0558886), (28.9300674, 41.0557436), (28.9301876, 41.0560879), (28.931101, 41.0561423), (28.9316779, 41.0564867), (28.9319663, 41.0569761), (28.9315577, 41.0575923), (28.9320625, 41.0577917), (28.9328076, 41.0577736), (28.9334358, 41.0568578), (28.9335287, 41.0567223), (28.9352113, 41.056668), (28.9363651, 41.0574292), (28.9378553, 41.0579548), (28.9390572, 41.0595317), (28.9361968, 41.0593142), (28.9362449, 41.0607098), (28.9365333, 41.0610179), (28.9360766, 41.0613622), (28.9351632, 41.0614166), (28.9348507, 41.0617247), (28.935019, 41.0621959), (28.934995, 41.0625403), (28.9341296, 41.0628665), (28.9344421, 41.0633196), (28.9345383, 41.063827), (28.9349709, 41.0646426), (28.9361487, 41.0640445), (28.9357161, 41.0647151), (28.9355959, 41.065893), (28.9338589, 41.065893), (28.9326852, 41.0679106), (28.9321218, 41.0691848), (28.9307134, 41.0691848), (28.9288825, 41.0697511), (28.9271924, 41.069928), (28.9262332, 41.0693857), (28.9254435, 41.0691202), (28.9247512, 41.0685477), (28.9239061, 41.0673089), (28.9222506, 41.0668501), (28.9211362, 41.0667071), (28.9194931, 41.0681229), (28.9172397, 41.0683353), (28.9164885, 41.069114), (28.9154575, 41.0695019), (28.9142858, 41.0712687), (28.913174, 41.0724919), (28.9143759, 41.0732167), (28.9153374, 41.0728996), (28.9160885, 41.0728996), (28.9168697, 41.0736245), (28.9173204, 41.0745758), (28.9172603, 41.0754138), (28.9166293, 41.076569), (28.9160284, 41.0770673), (28.9159383, 41.0777467), (28.9152172, 41.0788112), (28.9159984, 41.0796493), (28.9159082, 41.0810308), (28.9162087, 41.0821632), (28.9171101, 41.0823444), (28.9172002, 41.0833409), (28.917681, 41.0840882), (28.9185823, 41.0859226), (28.9188698, 41.0869529), (28.9193936, 41.0890477), (28.9211362, 41.0909273), (28.9214968, 41.0923539), (28.9223662, 41.0930165), (28.9225184, 41.0931691), (28.9217372, 41.0936219), (28.9208801, 41.0946066), (28.9180978, 41.0937341), (28.9149405, 41.092594), (28.9129344, 41.0918009), (28.9095141, 41.0910821), (28.9066857, 41.0907846), (28.9035614, 41.0907846), (28.8986283, 41.0911068), (28.8955039, 41.0911316), (28.8920507, 41.090859), (28.889025, 41.0903137), (28.8859665, 41.0893222), (28.8835986, 41.0883803), (28.8807045, 41.087017), (28.8782708, 41.0855297), (28.876462, 41.0838688), (28.874044, 41.0816226)]),
            '2': Polygon([(28.8079613, 41.0464171), (28.8080319, 41.0457623), (28.8083094, 41.0436959), (28.8102319, 41.0390047), (28.8105712, 41.0363605), (28.8106843, 41.0299626), (28.8109991, 41.027182), (28.8130591, 41.0267207), (28.8128329, 41.0250998), (28.8149816, 41.0231375), (28.8176957, 41.0221136), (28.8204098, 41.0208338), (28.8223323, 41.020066), (28.8249333, 41.0202366), (28.8267427, 41.0202366), (28.8274212, 41.0215164), (28.8286652, 41.0222843), (28.8311531, 41.0221136), (28.8373729, 41.0233081), (28.8397477, 41.0216871), (28.8422356, 41.0213458), (28.8438189, 41.0213458), (28.8475508, 41.0243319), (28.8485685, 41.0226256), (28.8485685, 41.0213458), (28.85558, 41.0211751), (28.85558, 41.0196393), (28.8577286, 41.019554), (28.8599529, 41.0176409), (28.8630599, 41.0194916), (28.8624058, 41.0204787), (28.8619152, 41.0218358), (28.8600346, 41.0237481), (28.859544, 41.0251669), (28.8584811, 41.0259688), (28.8582358, 41.0272024), (28.8593805, 41.0291146), (28.8629781, 41.0299164), (28.8648401, 41.0295158), (28.8649405, 41.0294847), (28.8650359, 41.0294847), (28.8671415, 41.0294713), (28.8677879, 41.0294369), (28.8687135, 41.0292462), (28.8708456, 41.0279477), (28.872381, 41.0276342), (28.8726723, 41.0284111), (28.872609, 41.0294947), (28.8725101, 41.030043), (28.8722012, 41.0315874), (28.8715746, 41.0339125), (28.8713873, 41.036308), (28.8712219, 41.0384458), (28.8676331, 41.0387814), (28.8659561, 41.039336), (28.860611, 41.040235), (28.8603794, 41.0428116), (28.8591635, 41.0427679), (28.859453, 41.0488814), (28.8555736, 41.0556929), (28.8544735, 41.059404), (28.8544735, 41.0618052), (28.8562684, 41.0663018), (28.8602057, 41.0713218), (28.8569632, 41.0721948), (28.8542685, 41.0721127), (28.8524384, 41.0716307), (28.8485624, 41.0677625), (28.8462964, 41.066016), (28.8437376, 41.065671), (28.8416681, 41.0658062), (28.8388684, 41.0669384), (28.8324965, 41.0702631), (28.8288913, 41.0698752), (28.8262899, 41.0704138), (28.8218799, 41.070472), (28.8183014, 41.0714257), (28.815547, 41.0723477), (28.8137376, 41.0698752), (28.8131722, 41.0675732), (28.8131722, 41.065527), (28.8117482, 41.061293), (28.8100057, 41.0561473), (28.8084916, 41.0499337), (28.8079613, 41.0464171)]),
            '3': Polygon([(28.620542, 41.0677635), (28.6207986, 41.066886), (28.6208733, 41.0667609), (28.626643, 41.056125), (28.62722, 41.0549668), (28.6276518, 41.0541), (28.6279518, 41.0534159), (28.6280891, 41.0525846), (28.6278388, 41.0446414), (28.6276988, 41.0437759), (28.6263535, 41.0402453), (28.6259288, 41.0393627), (28.6253505, 41.0384562), (28.6238714, 41.0364216), (28.6235551, 41.0357162), (28.6233609, 41.0348983), (28.623388, 41.0340122), (28.6235022, 41.0336605), (28.6239849, 41.0325489), (28.6262487, 41.0288603), (28.6268683, 41.0279194), (28.6274684, 41.0269782), (28.6281626, 41.0257901), (28.6282788, 41.02498), (28.6285563, 41.0242143), (28.6286576, 41.0234093), (28.628727, 41.022456), (28.628564, 41.0218175), (28.6283063, 41.0213841), (28.628417, 41.021295), (28.6297143, 41.02022), (28.6299994, 41.0200318), (28.6301676, 41.019863), (28.6304382, 41.019743), (28.6312098, 41.0193914), (28.6325436, 41.0188803), (28.6334481, 41.0185252), (28.6402286, 41.0159443), (28.6411088, 41.0156093), (28.6422044, 41.015055), (28.6442914, 41.0142548), (28.6446817, 41.0141046), (28.6455572, 41.0137678), (28.6495271, 41.0122405), (28.6496376, 41.0121906), (28.6504565, 41.0118842), (28.6542223, 41.0104399), (28.6568659, 41.0094037), (28.6593461, 41.0084582), (28.6607431, 41.0079237), (28.6614107, 41.0076683), (28.6617993, 41.0075196), (28.66346, 41.006964), (28.6653831, 41.0064803), (28.6668286, 41.0063061), (28.6686444, 41.0060802), (28.6691851, 41.0059954), (28.6796867, 41.0058898), (28.6818401, 41.0055229), (28.6839935, 41.0048414), (28.684512, 41.0043999), (28.6855912, 41.0036881), (28.6872584, 41.002063), (28.6901489, 41.0001152), (28.6918855, 40.9996565), (28.6938827, 40.9996565), (28.6964876, 40.9999842), (28.6972661, 40.9998507), (28.6976229, 40.9997894), (28.6983979, 40.9996565), (28.6984847, 41.0012948), (28.6990057, 41.0032607), (28.6988494, 41.0043354), (28.6984326, 41.0056459), (28.699683, 41.0065895), (28.7005861, 41.0083194), (28.7014891, 41.0094202), (28.6991968, 41.0110976), (28.6963487, 41.0123556), (28.7000998, 41.0154481), (28.7006555, 41.0173349), (28.7012807, 41.0218946), (28.7015185, 41.0267565), (28.7016975, 41.0288646), (28.6970433, 41.0290742), (28.6958624, 41.0313799), (28.6942647, 41.0315371), (28.6923197, 41.0315371), (28.690722, 41.0316419), (28.6909304, 41.0347335), (28.6905831, 41.0360958), (28.6923892, 41.037039), (28.6931533, 41.0380869), (28.6956874, 41.0399178), (28.6961893, 41.0404797), (28.6963631, 41.0406689), (28.6968966, 41.0416346), (28.6949049, 41.0415541), (28.690388, 41.0429759), (28.690388, 41.0454487), (28.6901914, 41.0466011), (28.6897495, 41.0474064), (28.6891349, 41.0481165), (28.6873871, 41.0497236), (28.6838305, 41.0527829), (28.6822189, 41.0550877), (28.6914265, 41.0577409), (28.6908326, 41.0585239), (28.6879984, 41.0594877), (28.6869425, 41.0602839), (28.6858867, 41.0613314), (28.6836082, 41.0619599), (28.6825523, 41.0625046), (28.6801072, 41.0625885), (28.6752168, 41.063636), (28.6726049, 41.0645578), (28.6663253, 41.0688733), (28.6639912, 41.0701721), (28.6599901, 41.073021), (28.6566237, 41.0751199), (28.6557666, 41.0757022), (28.6547663, 41.0767913), (28.6539327, 41.0775035), (28.6537104, 41.0796818), (28.6534325, 41.0817763), (28.6522832, 41.0843257), (28.6514875, 41.0860907), (28.6467172, 41.0909461), (28.646097, 41.0916194), (28.6444854, 41.0951793), (28.6395951, 41.0981109), (28.6385392, 41.0981109), (28.6392616, 41.0960169), (28.6372055, 41.0957238), (28.6355939, 41.0950118), (28.6347407, 41.0924399), (28.6340379, 41.0903211), (28.6335702, 41.0887553), (28.6303674, 41.0856899), (28.6291012, 41.0861866), (28.6282905, 41.0845535), (28.6290176, 41.0838044), (28.6280485, 41.0828232), (28.6268377, 41.0814269), (28.6258617, 41.0799931), (28.6207408, 41.0695321), (28.620542, 41.0686819), (28.620542, 41.0677635)]),
            '4': Polygon([(28.8324965, 41.0702631), (28.8388684, 41.0669384), (28.8416681, 41.0658062), (28.8437376, 41.065671), (28.8462964, 41.066016), (28.8485624, 41.0677625), (28.8524384, 41.0716307), (28.8542685, 41.0721127), (28.8569632, 41.0721948), (28.8602057, 41.0713218), (28.8562684, 41.0663018), (28.8544735, 41.0618052), (28.8544735, 41.059404), (28.8555736, 41.0556929), (28.859453, 41.0488814), (28.8591635, 41.0427679), (28.8603794, 41.0428116), (28.860611, 41.040235), (28.8659561, 41.039336), (28.8676331, 41.0387814), (28.8712219, 41.0384458), (28.8725461, 41.0384751), (28.8731099, 41.037664), (28.8744317, 41.0367972), (28.8746196, 41.0363905), (28.8745426, 41.0356654), (28.8753246, 41.0345423), (28.8755675, 41.0339247), (28.8763458, 41.0319459), (28.8795763, 41.0323836), (28.8825198, 41.0335555), (28.8852181, 41.0341722), (28.8899967, 41.0302391), (28.8905079, 41.0295341), (28.8912407, 41.0293912), (28.8921317, 41.0290027), (28.8904789, 41.0275313), (28.8897707, 41.0277943), (28.8870683, 41.0251196), (28.8852998, 41.0225761), (28.8870169, 41.0204787), (28.8865263, 41.0187513), (28.8867716, 41.0173941), (28.8884868, 41.017398), (28.8893156, 41.0173263), (28.8897888, 41.0173966), (28.890626, 41.0178445), (28.8923096, 41.0187492), (28.8929855, 41.0188504), (28.8971331, 41.0189606), (28.8974382, 41.0189687), (28.897704, 41.0189757), (28.8979139, 41.0189813), (28.8982755, 41.0189909), (28.8985457, 41.0189981), (28.8993633, 41.0201702), (28.9003936, 41.0210378), (28.9002073, 41.0216265), (28.8995827, 41.0235997), (28.8989745, 41.0276525), (28.8985758, 41.029824), (28.8972187, 41.0317349), (28.8962236, 41.0335093), (28.8946856, 41.0350106), (28.8930485, 41.0357794), (28.8894383, 41.037399), (28.8888033, 41.0378126), (28.8880813, 41.0384909), (28.8852188, 41.0428553), (28.8844082, 41.0445147), (28.8847556, 41.0490561), (28.885682, 41.0537718), (28.8853346, 41.0592294), (28.8844661, 41.0621982), (28.8784444, 41.070798), (28.8786181, 41.0771271), (28.8755794, 41.0801273), (28.874044, 41.0816226), (28.869354, 41.0862051), (28.8651851, 41.0887362), (28.862927, 41.0903945), (28.8603215, 41.0937546), (28.8582371, 41.0961109), (28.8538945, 41.1025685), (28.8519259, 41.105797), (28.8495842, 41.106617), (28.8497256, 41.1047063), (28.8499537, 41.1018797), (28.8486272, 41.0975372), (28.8461228, 41.0949452), (28.8429385, 41.0838449), (28.8389318, 41.0776532), (28.8368728, 41.0725059), (28.8324965, 41.0702631)]),
            '5': Polygon([(28.8784444, 41.070798), (28.8844661, 41.0621982), (28.8853346, 41.0592294), (28.885682, 41.0537718), (28.8847556, 41.0490561), (28.8844082, 41.0445147), (28.8852188, 41.0428553), (28.8880813, 41.0384909), (28.8888033, 41.0378126), (28.8894383, 41.037399), (28.8930485, 41.0357794), (28.8946856, 41.0350106), (28.8962236, 41.0335093), (28.8972187, 41.0317349), (28.8985758, 41.029824), (28.8989745, 41.0276525), (28.9008654, 41.0277883), (28.9022688, 41.0291818), (28.9047521, 41.0296406), (28.9079957, 41.0305199), (28.9085025, 41.0316669), (28.9107831, 41.0315139), (28.9117967, 41.0325462), (28.9150403, 41.0305964), (28.9160032, 41.0291818), (28.9163113, 41.0289059), (28.9192686, 41.0262795), (28.9197029, 41.0258938), (28.9238587, 41.0283025), (28.9209445, 41.0308157), (28.9189089, 41.0363605), (28.9161948, 41.0392606), (28.9155163, 41.0426724), (28.9178911, 41.0425019), (28.9150639, 41.0472781), (28.9134807, 41.0488132), (28.9120106, 41.0506042), (28.9114945, 41.0518916), (28.9105404, 41.0542712), (28.909442, 41.0554936), (28.9068088, 41.0573484), (28.9026243, 41.0604962), (28.9004757, 41.0647596), (28.8976602, 41.0668823), (28.8946051, 41.0691856), (28.8943689, 41.0693637), (28.8887153, 41.071928), (28.8856709, 41.0739449), (28.8855621, 41.074004), (28.8819293, 41.0754167), (28.8786181, 41.0771271), (28.8784444, 41.070798)]),
            '6': Polygon([(28.8242218, 41.1343087), (28.8245247, 41.1334533), (28.8261905, 41.1316853), (28.8281592, 41.1298603), (28.8317936, 41.1274649), (28.8438329, 41.1192513), (28.8449687, 41.1182816), (28.8451174, 41.1174869), (28.8446658, 41.1154865), (28.8446658, 41.11252), (28.8455744, 41.1116073), (28.8476188, 41.1102951), (28.8495842, 41.106617), (28.8519259, 41.105797), (28.8538945, 41.1025685), (28.8582371, 41.0961109), (28.8603215, 41.0937546), (28.862927, 41.0903945), (28.8651851, 41.0887362), (28.869354, 41.0862051), (28.874044, 41.0816226), (28.876462, 41.0838688), (28.8782708, 41.0855297), (28.8807045, 41.087017), (28.8835986, 41.0883803), (28.8859665, 41.0893222), (28.889025, 41.0903137), (28.8920507, 41.090859), (28.8955039, 41.0911316), (28.8986283, 41.0911068), (28.9035614, 41.0907846), (28.9066857, 41.0907846), (28.9095141, 41.0910821), (28.9129344, 41.0918009), (28.9149405, 41.092594), (28.9180978, 41.0937341), (28.9208801, 41.0946066), (28.9200052, 41.0951518), (28.9185845, 41.0964605), (28.9182951, 41.0981854), (28.919137, 41.1000491), (28.9203452, 41.1023065), (28.9200589, 41.1060435), (28.9216005, 41.1082698), (28.9218574, 41.1092378), (28.9200589, 41.1137386), (28.9184531, 41.1152872), (28.916526, 41.1153356), (28.9135713, 41.1152388), (28.9116443, 41.1163034), (28.9106808, 41.1182391), (28.9074691, 41.1202714), (28.9074691, 41.1229812), (28.9069552, 41.1249167), (28.9027158, 41.1268521), (28.9010457, 41.1285455), (28.8992472, 41.1331901), (28.8962282, 41.1354639), (28.8925026, 41.1363831), (28.8901902, 41.1372055), (28.888199, 41.1390438), (28.8851157, 41.1451388), (28.8808763, 41.1475573), (28.8795608, 41.1465358), (28.8787386, 41.144183), (28.8777109, 41.1432233), (28.8761487, 41.1422945), (28.8748743, 41.1423255), (28.8737232, 41.1432543), (28.8737232, 41.144183), (28.8754087, 41.1465977), (28.8759843, 41.1480217), (28.8757787, 41.1503433), (28.8744221, 41.1518291), (28.8724899, 41.1526959), (28.8704345, 41.1528506), (28.8679268, 41.1521387), (28.8665702, 41.1518291), (28.8658302, 41.1523863), (28.8659124, 41.1535935), (28.8669813, 41.1562554), (28.8669401, 41.1571531), (28.8638158, 41.1585768), (28.8614726, 41.1597839), (28.8606093, 41.1593506), (28.8590471, 41.158453), (28.857896, 41.1581435), (28.8549773, 41.1569054), (28.8525929, 41.1551412), (28.8483586, 41.1539959), (28.8484408, 41.1531602), (28.8468787, 41.1530054), (28.8460154, 41.1519839), (28.8435077, 41.1514267), (28.8426855, 41.1510862), (28.8409589, 41.1476502), (28.8397667, 41.1467215), (28.8355735, 41.1433162), (28.8336414, 41.1426041), (28.8329425, 41.141954), (28.8326547, 41.1411491), (28.8330247, 41.1401893), (28.8329836, 41.1394153), (28.8326136, 41.1366908), (28.8328192, 41.1360096), (28.8334769, 41.1346163), (28.8332616, 41.1336818), (28.8332405, 41.1336927), (28.8330732, 41.1337797), (28.832033, 41.1343469), (28.8319866, 41.1343736), (28.8305993, 41.1351736), (28.8284204, 41.135669), (28.8266527, 41.1357619), (28.8242975, 41.1355063), (28.8242218, 41.1343087)])
            }

##point inside polygon test
def get_random_point_in_polygon(poly):

     minx, miny, maxx, maxy = poly.bounds
     while True:
         p = Point(rand.uniform(minx, maxx),rand.uniform(miny, maxy))
         if poly.contains(p):
             return p


def create_json(point):
    #41,14919-41,00009
    random_lat = point.y
    #28,40250-2,94448
    random_lon = point.x
    random_vstate = rand.randint(1,4)
    messageId = date.datetime.now().timestamp()
    userId = date.datetime.now().timestamp()
    message_user = ['iyiyim,enkaz altinda degilim','iyiyim, ama enkaz altindayim','yaralandim,ancak enkaz altinda degilim','yaralandim ve enkaz altindayım. Yardim edin!!']
    data_json={'data': message_user[rand.randint(0,3)],'location':{'lat':random_lat,'lon':random_lon},'vstate':random_vstate,'messageId':messageId,'userId':userId}
    return data_json



#get x,y coordinate inside polygon
while (counter != 0):
    for i in poly_dict:
        x = poly_dict[i]
        poly_i=get_random_point_in_polygon(x)
        data_final = create_json(get_random_point_in_polygon(poly_i))
        resp = r.post(url,json=data_final)
        t.sleep(1)
        print(resp.text)
counter -= 1
